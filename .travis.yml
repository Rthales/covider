dist: bionic
matrix:
  include:
  - language: generic
    deploy:
      provider: heroku
      api_key:
        secure: VJ0JU8E9mxeCCec/lxFpG82hRDr2KnTUvrBQ9iEeDSjRnpUaEkp5NoFouQzs+ED6qUKyBViUTer/wBMFCtatamqs9iLISqfVLUrvfDiFAb2dD/Y+AgLzLyFESBQgMBZ45Nxc+ZNhvm5ezYppGAANHIYV9UNXjhT4bO+aL9VGq272XHt1PTV3yw7kj45Z4ZqdGm0HHYpnZa6l/2+ENiOBmYGexIhmm3WboImV74rNh9DsEWfrTsZL85Fwof8FxaidjCqIAWUEpdxs+3+Znwdv+EMFugqEwVr15KSD1SP27fiM4PN5RhOTPL2k+nCIqpYsFWmvWKlVSOLAhyOvAA6u11XByIgZPXE/Cvy6OVfcir14Szv9EHTHlGTpODKpFcqi+Ms0322bWg6NuLYVoyCy1Dc1Ktg7opc4eg1wfuSJROlPFP1rFzhebv93iHDHrhsEtEqopn/DgqLWQiFpEATVjXvRlW9ui61dRKmW1z/b7yo1uXESLLnSnmijHxRw6clupGkj83t/jqSA2V5zGf+/Awi95biN2glRIp68Py3KLaXYW06EdtJTmZNEeP5btXzoM5UBZB8XxPRHzyRjxT6TjGRttPyADLWR3Sxd9U+VChMqVRSAe4Yyq6744BLRKc87vWKjejJ94qr2z2mReBAJLT6mq6dVwsThmKwgQACQf4M=
      app: covider
      on: registration-module
    before_install:
    - echo $JAVA_HOME
    - which java
    - sudo rm -rf /usr/local/lib/jvm/
    - sudo apt-get install -y openjdk-11-jdk-headless
    - export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64/
    - which java
    - java -version
    - "$JAVA_HOME/bin/java -version"
    before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
    cache:
      directories:
      - "$HOME/.gradle/caches/"
      - "$HOME/.gradle/wrapper/"
      - "$HOME/.m2"
    before_script:
      - cd webapp
      - chmod +x gradlew
    script:
      - date
      - "./gradlew check build -x test"

  - language: node_js
    node_js:
      - '8'
    cache:
      directories:
      - "$HOME/.npm"
    before_script:
      - date
      - cd webapp
    run:
      - npm run build
