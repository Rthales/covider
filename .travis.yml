dist: bionic
matrix:
  include:
  - language: generic
    deploy:
      provider: heroku
      api_key:
        secure: LVQX77pVSFi0GXsv73hh7H2A3RjTz4JbmBBkO9/R89z32NlRW6kHROIiS1pkNnJy8/YXHZpH0RIPaP6qtRUKxd3ueamzWipSomwnmt9QGcQ472hW7GikDL09UJLSxnHTCODS2QulXkXvfQvXY41bVDzHmbmgsAwh34ZxSVyE/lgySQn7x4GJ7XvTdEOdwBkdh3CwA0pmxoCddmtdFSa03sXrriEZ8QAVgsykXdMl+hfzgB6sV712nwBqvf007YMY+PtNk1EU63njinU8lpoD+ZUR4AOIM2qaof+PF0//mIoXNmNlewj5H8Fgw9OIKSirFv0K4kKWDlYe/P2SXAVmDz1NPypO0i+pchBjYv9BCSoJsyhVMpaWY2x9IxTBJugKTV4rcoYFgPgzT1bR73ntjn4dMAl9dyv24Zw+MnhKVNYHAdioSwwuBYqwa75zerTaMWGPAP5jrZ9JVHOh3nZrt3VBIoBAOKsVER7Xq915QWO7QqmukC/9zhmwBU7dzrCyDGz6/K4WoYKzZHyu9Rb3FZiAOgeA2XzeR3aFfiQfminCGtpQ4+LExgdfG9r1N2Rz0P7IFn34LDSmKGDRQ7Gmjx5optq7pucPnW81lZAJVbSGSsUbCX4cvGgmACq2rnsMeyhzpq9y8B8YYOKuwpxQDDtIb/mp97/kOGH0PopufyY=
      app: covider
      on: registration-module
    before_install:
    - echo $JAVA_HOME
    - which java
    - sudo rm -rf /usr/local/lib/jvm/
    - sudo apt-get install -y openjdk-11-jdk-headless
    - export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64/
    - which java
    - java -version
    - "$JAVA_HOME/bin/java -version"
    before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
    cache:
      directories:
      - "$HOME/.gradle/caches/"
      - "$HOME/.gradle/wrapper/"
      - "$HOME/.m2"
    before_script:
      - cd webapp
      - chmod +x gradlew
    script:
      - date
      - "./gradlew check build -x test"

  - language: node_js
    node_js:
      - '8'
    cache:
      directories:
      - "$HOME/.npm"
    before_script:
      - date
      - cd webapp
      - npm install
    run:
      - npm run build